package com.lesso.quartz;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.quartz.Job;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

import com.lesso.util.SqlserverDBUtils;


/** * @author  Lance 
 * @date 创建时间：2016年1月13日 下午4:58:38 
 * @version 1.0 
 * @parameter  
 * @since  
 * @return  */
public class syncZknaJob implements Job{

	@Override
	public void execute(JobExecutionContext arg0) throws JobExecutionException {
		Log logs = LogFactory.getLog(syncZknaJob.class);
		try{
			Connection conn = SqlserverDBUtils.createConn();
			String sql = "select m.KUNNR,m.LOGIN_ID,m.PASSWORD,m.REGIO,"
					+ "m.NAME1,i.DQNAME,k.VKORG from MST_SAP_KNA1 m "
					+ "left join MST_DQ i "
					+ "on m.REGIO = i.DQNO "
					+ "left join MST_SAP_KNB1 k "
					+ "on m.KUNNR = k.KUNNR "
					+ "where m.LOGIN_ID !='null' and m.PASSWORD!= 'null'";
			PreparedStatement ps = SqlserverDBUtils.getPs(conn, sql);
			ResultSet rs = ps.executeQuery();
			while(rs.next()){
				String Kunnr = rs.getString("kunnr");
				String name = rs.getString("name1"); 
				String vkorg = rs.getString("VKORG");
				String Login_id = rs.getString("login_id");
				String pwd = rs.getString("password");
				String area = rs.getString("regio");
				String area_name = rs.getString("dqname");
			}
		}catch(Exception e){
			e.printStackTrace();
		}
	}

}
