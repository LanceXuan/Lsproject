package com.lesso.daoImpl;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import com.lesso.beans.CcNotice;
import com.lesso.beans.IMUser;
import com.lesso.dao.CcNoticeDao;
import com.lesso.util.DBUtils;

public class CcNoticeDaoImpl extends BaseDaoImpl<CcNotice> implements CcNoticeDao{

	@Override
	public int saveCcNotice(CcNotice ccNotice) {
		// TODO Auto-generated method stub
		try{
     		Connection conn = DBUtils.createConn();
     		String sql ="insert into Notices (title,content,FirstImg,Sendor,Reviceor,readStatus,created)"
     				+ " values('"+ccNotice.getTitle()+"','"+ccNotice.getContent()+"','"+ccNotice.getFirstImg()+"',"
					+ "'"+ccNotice.getSendor()+"','"+ccNotice.getReviceor()+"','"+ccNotice.getReadStatus()+"','"+ccNotice.getCreated()+"')";
     		Statement st=conn.createStatement();		    				
 			int ds = st.executeUpdate(sql);

 			DBUtils.close(conn);
 			if(st != null){
 				st.close();
 			}
 			return ds;
     	}catch(Exception e){
     		e.printStackTrace();
     		return 0;
     	} 
	}

	@Override
	public CcNotice getCcNotice(int id) {
		// TODO Auto-generated method stub
		try{
     		Connection conn = DBUtils.createConn();
     		String sql = "select * from Notices where id="+id;
 			PreparedStatement ps = DBUtils.getPs(conn, sql);
  			ResultSet rs = ps.executeQuery();
  			CcNotice mp = null;
  			while(rs.next()){
  				mp = new CcNotice();
  				mp.setCreated(rs.getString("Created"));
  				mp.setTitle(rs.getString("title"));
  				mp.setId(Integer.parseInt(rs.getString("id")));
  				mp.setContent(rs.getString("content"));
  				mp.setSendor(rs.getString("sendor"));
  				mp.setReviceor(rs.getString("reviceor"));
  				mp.setReadStatus(Integer.parseInt(rs.getString("readStatus")));
  				mp.setUpdated(rs.getString("updated"));
  			}
  			DBUtils.close(ps);
 			DBUtils.close(conn);
 			if(rs != null){
 				rs.close();
 			}
 			return mp; 
     	}catch(Exception e){
     		e.printStackTrace();
     		return null;
     	}
	}
	
}
